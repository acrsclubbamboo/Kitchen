<!DOCTYPE html>
<html>
  <head>
    <!-- Other head tags here -->
    <style>
      /* Your existing CSS styles */
      body {
        padding: 0;  /* No padding on the sides */
        margin: 0;  /* No margin */
      }

      #output {
      }
      
      table {
        font-size: 24px; /* Increase font size */
        margin: 0 auto;
      }

      th {
        font-size: 30px; /* Increase font size for headers */
        font-weight: bold; /* Make headers bold */
        text-align: center; /* Center headers */
        background-color: white;
      }

      td {
        font-weight: bold; /* Make cell text bold */
        text-align: center; /* Center cell text */
        padding-right: 5px; /* Reduce gap after each column */
        max-width: 500px; /* Add a max-width */
        word-wrap: break-word; /* Add word wrap */
      }
      td:nth-child(2), th:nth-child(2) {
        text-align: center; /* Center Time column */
      }

      /* Style for the total meals and veggie count */
      .totals {
        font-weight: bold;
        font-style: italic;
        padding-right: 30px; /* Add more space to the right */
        font-size: 32px; /* Bigger size for the totals row */
        background-color: white;
      }

      /* Style for the green veggie meals count */
      .veggie {
        color: green;
      }

      /* Alternate row colors */
      tr:nth-child(odd) {
        background-color: #b3d9ff; /* light blue */
      }

      tr:nth-child(even) {
        background-color: white;
      }
    </style>
    <script>
    setInterval(function() {
      console.log('Fetching data...');
      fetch('https://script.google.com/macros/s/AKfycbw6HdkhKYFk-CX7wzGC3CAz4aHJo2ZNDzxYQbY_4VwF2TlybKp8ecZ2eQEzQ4UYeW_7/exec')
      .then(response => response.json())
      .then(data => {
        var outputDiv = document.getElementById('output');

        // Clear previous data
        outputDiv.innerHTML = '';

        // Create a table for the current reservations
        var currentTable = document.createElement('table');
        outputDiv.appendChild(currentTable);

        // Populate the current reservations table
        var currentHeaderRow = document.createElement('tr');
        var currentHeaders = ["Name", "Time", "# of Meals", "Comments"];
        currentHeaders.forEach(header => {
          var th = document.createElement('th');
          th.textContent = header;
          currentHeaderRow.appendChild(th);
        });
        currentTable.appendChild(currentHeaderRow);

        // Loop over each row in the data
        data.currentReservationsData.forEach((row, index) => {

          // Create a new row in the table
          var currentTableRow = document.createElement('tr');
          currentTable.appendChild(currentTableRow);

          // Check the validity of the time value before creating a Date object and calling substring
          var timeString = '';
          if (row.time) {
            if(typeof row.time == 'string' && row.time.includes('T')) {
              var dateObject = new Date(row.time);
              if (dateObject instanceof Date && !isNaN(dateObject)) {
                var dateString = dateObject.toUTCString();
                var dateParts = dateString.split(' ');
                if (dateParts.length > 4) {
                  timeString = dateObject.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false, timeZone: 'America/Los_Angeles' });
                }
              }
            } else {
              timeString = row.time; // If not a Date, use the original value
            }
          } else {
            // Default value if Time is empty
            timeString = "12:00";
          }

          var columns = [row.name, timeString, row.numberOfMeals, row.comments];

          for (var i = 0; i < columns.length; i++) {
            var currentTableCell = document.createElement('td');
            currentTableCell.textContent = columns[i];
            currentTableRow.appendChild(currentTableCell);
          }
        });
        // Add a break between the tables
        var breakLine = document.createElement('br');
        outputDiv.appendChild(breakLine);

        // Create a table for the future reservations
        var futureTable = document.createElement('table');
        outputDiv.appendChild(futureTable);

        // Populate the future reservations table
        var futureHeaderRow = document.createElement('tr');
        var futureHeaders = ["Day", "Date", "Formatted Date", "# of Reservations"];
        futureHeaders.forEach(header => {
          var th = document.createElement('th');
          th.textContent = header;
          futureHeaderRow.appendChild(th);
        });
        futureTable.appendChild(futureHeaderRow);

        data.futureReservationsData.forEach((row) => {
            var futureTableRow = document.createElement('tr');
            futureTable.appendChild(futureTableRow);

            var columns = [row.dayDescription, row.date, row.formattedDate, row.numberOfReservations];

            for (var i = 0; i < columns.length; i++) {
                var futureTableCell = document.createElement('td');
                futureTableCell.textContent = columns[i];
                futureTableRow.appendChild(futureTableCell);
            }
        });
        })
        .catch(error => console.error('Error:', error));
      }, 5000); // Reduced to 5 seconds for testing
    </script>
  </head>
  <body>
    <!-- Your webpage content here -->
    <div id="output"></div>
  </body>
</html>

